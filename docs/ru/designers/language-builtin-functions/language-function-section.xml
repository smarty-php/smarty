<?xml version="1.0" encoding="windows-1251"?>
<!-- $Revision$ -->
<!-- EN-Revision: 1.3 Maintainer: tony2001 Status: ready -->
<sect1 id="language.function.section">
 <title>section,sectionelse</title>
 <informaltable frame="all">
  <tgroup cols="5">
  <colspec colname="param" align="center" />
  <colspec colname="type" align="center" />
  <colspec colname="required" align="center" />
  <colspec colname="default" align="center" />
  <colspec colname="desc" />
  <thead>
   <row>
    <entry>Имя аттрибута</entry>
    <entry>Тип</entry>
    <entry>Обязателен</entry>       
    <entry>По умолчанию</entry>
    <entry>Описание</entry>
   </row>
  </thead>
  <tbody>
   <row>
    <entry>name</entry>
    <entry>строка (string)</entry>
    <entry>Да</entry>
    <entry><emphasis>n/a</emphasis></entry>
    <entry>Название секции</entry>
   </row>
   <row>
    <entry>loop</entry>
    <entry>[$variable_name]</entry>
    <entry>Да</entry>
    <entry><emphasis>n/a</emphasis></entry>
    <entry>Имя переменной цикла, для определения 
    количества итераций цикла.</entry>
   </row>
   <row>
    <entry>start</entry>
    <entry>целое (integer)</entry>
    <entry>Нет</entry>
    <entry><emphasis>0</emphasis></entry> 
    <entry>
     Индекс позиции, с которой будет начинаться
     цикл. Если значение отрицательное, то начальная позиция
     вычисляется от конца массива. Например, если в переменной 
     цикла 7 элементов и значение атрибута start равно -2, то
     начальный индекс будет 5. Неверные значения (значения, вне
     массива) автоматически обрезаются до ближайшего верного 
     значения.
    </entry>
   </row>
   <row>
    <entry>step</entry>
    <entry>целое (integer)</entry>
    <entry>Нет</entry>
    <entry><emphasis>1</emphasis></entry>
    <entry>
     Значение шага, которое используется для прохода по
     массиву. Например, step=2 указывает обход массива 
     по элементам 0,2,4... Если шаг отрицателен, то обход 
     массива будет производится в обратном направлении.
    </entry>
   </row>
   <row>
    <entry>max</entry>
    <entry>целое (integer)</entry>
    <entry>Нет</entry>
    <entry><emphasis>1</emphasis></entry>
    <entry>Максимальное количество итераций цикла.</entry>
   </row>
   <row>
    <entry>show</entry>
    <entry>логический (boolean)</entry>
    <entry>Нет</entry>
    <entry><emphasis>true</emphasis></entry>
    <entry>Указывает, показывать или нет эту секцию</entry>
   </row>
  </tbody>
  </tgroup>
 </informaltable>
 <para>
  Секции используются для обхода массива данных. Все тэги
  <emphasis>section</emphasis> должны иметь в пару тэг
  <emphasis>/section</emphasis>. Обязательные параметры:
  <emphasis>name</emphasis> и <emphasis>loop</emphasis>. Имя
  секции может быть какой угодно последовательностью букв, 
  цифр и знаков подчеркиваний. Секции могут быть вложенными. 
  Имена вложенных секций должны отличаться друг от друга. 
  Переменная цикла (обычно массив) определяет количество итериций 
  цикла. Когда отображаем переменную цикла, имя секции должно 
  быть указана после имени переменной в квадратных скобках [].
  Тэг <emphasis>sectionelse</emphasis> выполняется, когда
  переменная цикла пуста.
 </para>
 <example>
  <title>section</title>
  <programlisting>
<![CDATA[
{* этот пример выведет все значения массива $custid *}
{section name=customer loop=$custid}
	id: {$custid[customer]}<br>
{/section}

OUTPUT:

id: 1000<br>
id: 1001<br>
id: 1002<br>
]]>
  </programlisting>
 </example>

 <example>
  <title>section loop variable</title>
  <programlisting>
<![CDATA[
{* Переменная цикла определяет только количество итераций цикла.
   Вы имеете доступ к любой переменной шаблона в секции.
   Этот пример подразумевает, что каждый из массивов $custid, $name и $address 
   содержат одинаковое количество значений *}
{section name=customer loop=$custid}
	id: {$custid[customer]}<br>
	name: {$name[customer]}<br>
	address: {$address[customer]}<br>
	<p>
{/section}


OUTPUT:

id: 1000<br>
name: John Smith<br>
address: 253 N 45th<br>
<p>
id: 1001<br>
name: Jack Jones<br>
address: 417 Mulberry ln<br>
<p>
id: 1002<br>
name: Jane Munson<br>
address: 5605 apple st<br>
 <p>
]]>
  </programlisting>
 </example>

 <example>
  <title>имена секций</title>
  <programlisting>
<![CDATA[
{* имя секции может быть любым и используется для указания 
   данных в секции *}
{section name=mydata loop=$custid}
	id: {$custid[mydata]}<br>
	name: {$name[mydata]}<br>
	address: {$address[mydata]}<br>
	<p>
{/section}
]]>
  </programlisting>
 </example>

 <example>
  <title>вложенные секции</title>
  <programlisting>
<![CDATA[
{* секции могут быть неограничено вложеннымиas. С помощью вложенных секций
   вы можете организовать доступ к комплексным стрктурам информации, таким 
   как многомерные массивы. В данном примере $contact_type[customer] является
   массивом, где содержатся типа контактов данного клиент. *}
{section name=customer loop=$custid}
	id: {$custid[customer]}<br>
	name: {$name[customer]}<br>
	address: {$address[customer]}<br>
	{section name=contact loop=$contact_type[customer]}
		{$contact_type[customer][contact]}: {$contact_info[customer][contact]}<br>
	{/section}
	<p>
{/section}


OUTPUT:

id: 1000<br>
name: John Smith<br>
address: 253 N 45th<br>
home phone: 555-555-5555<br>
cell phone: 555-555-5555<br>
e-mail: john@mydomain.com<br>
<p>
id: 1001<br>
name: Jack Jones<br>
address: 417 Mulberry ln<br>
home phone: 555-555-5555<br>
cell phone: 555-555-5555<br>
e-mail: jack@mydomain.com<br>
<p>
id: 1002<br>
name: Jane Munson<br>
address: 5605 apple st<br>
home phone: 555-555-5555<br>
cell phone: 555-555-5555<br>
e-mail: jane@mydomain.com<br>
 <p>
]]>
  </programlisting>
 </example>

 <example>
  <title>секции и ассоциативные массивы</title>
  <programlisting>
<![CDATA[
{* Пример вывода ассоциативного массива. *}
{section name=customer loop=$contacts}
	name: {$contacts[customer].name}<br>
	home: {$contacts[customer].home}<br>
	cell: {$contacts[customer].cell}<br>
	e-mail: {$contacts[customer].email}<p>
{/section}


OUTPUT:

name: John Smith<br>
home: 555-555-5555<br>
cell: 555-555-5555<br>
e-mail: john@mydomain.com<p>
name: Jack Jones<br>
home phone: 555-555-5555<br>
cell phone: 555-555-5555<br>
e-mail: jack@mydomain.com<p>
name: Jane Munson<br>
home phone: 555-555-5555<br>
cell phone: 555-555-5555<br>
e-mail: jane@mydomain.com<p>
]]>  
  </programlisting>
 </example>

 <example>
  <title>sectionelse</title>
  <programlisting>
<![CDATA[
{* sectionelse обработается, когда $custid не содержит значений *}
{section name=customer loop=$custid}
	id: {$custid[customer]}<br>
{sectionelse}
	there are no values in $custid.
{/section}
]]> 
  </programlisting>
 </example>
	<para>
		Секции также имеют свои собственные аттрибуты, которые определяют 
		определенные настройки секции. Они указываются примерно так: 
		{$smarty.section.sectionname.varname}
	</para>
	<para>
		ЗАМЕЧАНИЕ: Начиная со Smarty версии 1.5.0, синтаксис аттрибутов секций 
		изменился с {%sectionname.varname%} на {$smarty.section.sectionname.varname}. 
		Старый синтаксис пока поддерживается, но вы встретите только новый стиль в
  примерах данного руководства.
 </para>
 
	<sect2 id="section.property.index">	
		<title>index</title>
		<para>
	 	index хранит текущий индекс цикла, начиная с 0 (или значения аттрибута 
			start), и увеличивается на единицу (или на значение аттрибута step).
		</para>
		<note>
			<title>Техническое Замечание</title>
			<para>
		 	Если аттрибуты step и start не указаны, то index 
				аналогичен аттрибуту секции iteration, кроме того, 
				что начинается с 0, а не с 1.				
			</para>
		</note>
 	<example>
	  <title>аттрибут секции index</title>
   <programlisting>
<![CDATA[
	{section name=customer loop=$custid}
	{$smarty.section.customer.index} id: {$custid[customer]}<br>
	{/section}


	OUTPUT:

	0 id: 1000<br>
	1 id: 1001<br>
 2 id: 1002<br>
]]>   
   </programlisting>
 	</example>
 </sect2>
 
	<sect2 id="section.property.index.prev">	
		<title>index_prev</title>
		<para>
			index_prev хранит предыдущий индекс цикла.
  	На первой итерации устанавливается в -1.
		</para>
	 <example>
  	<title>аттрибут секции index_prev</title>
  	<programlisting>
<![CDATA[
	{section name=customer loop=$custid}
	{$smarty.section.customer.index} id: {$custid[customer]}<br>
	{* FYI, $custid[customer.index] and $custid[customer] are identical in meaning *}
	{if $custid[customer.index_prev] ne $custid[customer.index]}
    	The customer id changed<br>
	{/if}
	{/section}


	OUTPUT:

	0 id: 1000<br>
    	The customer id changed<br>
	1 id: 1001<br>
    	The customer id changed<br>
	2 id: 1002<br>
     The customer id changed<br>
]]>
   </programlisting>
 	</example>
 </sect2>
 
	<sect2 id="section.property.index.next">
		<title>index_next</title>
		<para>
  	index_next хранит следующий индекс цикла. На последней итерации цикла
  	будет иметь значение на единицу больше текущего индекса (или на другое
  	значение, если указан аттрибут step).
		</para>
	 <example>
  	<title>аттрибут секции index_next</title>
   <programlisting>
<![CDATA[
	{section name=customer loop=$custid}
	{$smarty.section.customer.index} id: {$custid[customer]}<br>
	{* FYI, $custid[customer.index] and $custid[customer] are identical in meaning *}
	{if $custid[customer.index_next] ne $custid[customer.index]}
    	The customer id will change<br>
	{/if}
	{/section}


	OUTPUT:

	0 id: 1000<br>
    	The customer id will change<br>
	1 id: 1001<br>
    	The customer id will change<br>
	2 id: 1002<br>
     The customer id will change<br>
]]>
   </programlisting>
 	</example>
 </sect2>
 
	<sect2 id="section.property.iteration">
		<title>iteration</title>
		<para>
  	iteration хранит текущую итерацию цикла.
		</para>
		<para>
	 	ЗАМЕЧАНИЕ: Значение не зависит от аттрибутов start, step и max, в отличии
			аттрибута index. Итерации также начинаются с 1, а не с 0, как index.
			rownum является синонимом для iteration.
		</para>
 	<example>
  	<title>аттрибут секции iteration</title>
  	<programlisting>
<![CDATA[
	{section name=customer loop=$custid start=5 step=2}
	current loop iteration: {$smarty.section.customer.iteration}<br>
	{$smarty.section.customer.index} id: {$custid[customer]}<br>
	{* FYI, $custid[customer.index] and $custid[customer] are identical in meaning *}
	{if $custid[customer.index_next] ne $custid[customer.index]}
    	The customer id will change<br>
	{/if}
	{/section}


	OUTPUT:

	current loop iteration: 1
	5 id: 1000<br>
    	The customer id will change<br>
	current loop iteration: 2
	7 id: 1001<br>
    	The customer id will change<br>
	current loop iteration: 3
	9 id: 1002<br>
     The customer id will change<br>
]]>
   </programlisting>
 	</example>
 </sect2>
 
	<sect2 id="section.property.first">
		<title>first</title>
		<para>
  	first имеет значение истина, если текущая итерация цикла - первая.
		</para>
 	<example>
  	<title>аттрибут секции first</title>
  	<programlisting>
<![CDATA[
	{section name=customer loop=$custid}
	{if $smarty.section.customer.first}
    	<table>
	{/if}

	<tr><td>{$smarty.section.customer.index} id:
        	{$custid[customer]}</td></tr>

	{if $smarty.section.customer.last}
    	</table>
	{/if}
	{/section}


	OUTPUT:

	<table>
	<tr><td>0 id: 1000</td></tr>
	<tr><td>1 id: 1001</td></tr>
	<tr><td>2 id: 1002</td></tr>
 </table>
]]>
   </programlisting>
 	</example>
 </sect2>
 
	<sect2 id="section.property.last">
		<title>last</title>
		<para>
  	last имеет значение истина, если текущая итерация цикла - последняя.
  	one.
		</para>
	 <example>
  	<title>аттрибут секции last</title>
   <programlisting>
<![CDATA[
	{section name=customer loop=$custid}
	{if $smarty.section.customer.first}
    	<table>
	{/if}

	<tr><td>{$smarty.section.customer.index} id:
        	{$custid[customer]}</td></tr>

	{if $smarty.section.customer.last}
    	</table>
	{/if}
	{/section}


	OUTPUT:

	<table>
	<tr><td>0 id: 1000</td></tr>
	<tr><td>1 id: 1001</td></tr>
	<tr><td>2 id: 1002</td></tr>
 </table>
 ]]>
   </programlisting>
 	</example>
 </sect2>
 
	<sect2 id="section.property.rownum">	
		<title>rownum</title>
		<para>
	 	rownum хранит текущую итерацию цикла, начиная с 1.
			rownum - синоним для iteration.
		</para>
 	<example>
  	<title>аттрибут секции rownum</title>
  	<programlisting>
<![CDATA[
	{section name=customer loop=$custid}
	{$smarty.section.customer.rownum} id: {$custid[customer]}<br>
	{/section}


	OUTPUT:

	1 id: 1000<br>
	2 id: 1001<br>
 3 id: 1002<br>
]]>   
   </programlisting>
 	</example>
 </sect2>
 
	<sect2 id="section.property.loop">	
		<title>loop</title>
		<para>
			loop хранит последний отработанный индекс цикла. Может быть использован 
			как внутри секции, так и после нее.
		</para>
 	<example>
  	<title>аттрбут секции index</title>
  	<programlisting>
<![CDATA[
	{section name=customer loop=$custid}
	{$smarty.section.customer.index} id: {$custid[customer]}<br>
	{/section}

	There were {$smarty.section.customer.loop} customers shown above.

	OUTPUT:

	0 id: 1000<br>
	1 id: 1001<br>
	2 id: 1002<br>

 There were 3 customers shown above.
]]> 
   </programlisting>
 	</example>
 </sect2>
 
	<sect2 id="section.property.show">	
		<title>show</title>
		<para>
  	Аттрибут <emphasis>show</emphasis> может принимать логические 
  	значения (истина или ложь). Если ложь, то цикл foreach не будет
   отображаться. Если присутствует тэг foreachelse, то он будет
   отображен.
		</para>
  <example>
  	<title>аттрибут секции show</title>
  	<programlisting>
<![CDATA[
	{* $show_customer_info может быть передана из PHP программы
	укаызвая, показывать или нет эту секцию *}
	{section name=customer loop=$custid show=$show_customer_info}
	{$smarty.section.customer.rownum} id: {$custid[customer]}<br>
	{/section}

	{if $smarty.section.customer.show}
	the section was shown.
	{else}
	the section was not shown.
	{/if}


	OUTPUT:

	1 id: 1000<br>
	2 id: 1001<br>
	3 id: 1002<br>

 the section was shown.
]]> 
   </programlisting>
	 </example>
 </sect2>
 
	<sect2 id="section.property.total">	
		<title>total</title>
		<para>
			total хранит количество всех итераций цикла. Может быть использвован
			как в секции, так и после нее.
		</para>
 	<example>
  	<title>аттрибут секции total</title>
   <programlisting>
<![CDATA[
	{section name=customer loop=$custid step=2}	
	{$smarty.section.customer.index} id: {$custid[customer]}<br>
	{/section}

	There were {$smarty.section.customer.total} customers shown above.

	OUTPUT:

	0 id: 1000<br>
	2 id: 1001<br>
	4 id: 1002<br>

 There were 3 customers shown above.
 ]]>  
   </programlisting>
 	</example>
 </sect2>

</sect1>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->

